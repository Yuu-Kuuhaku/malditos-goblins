
<div class="container mt-2">

  <h2>Plataforma não oficial para jogar <a mat-button href="https://coisinhashop.com.br/produtos/malditos-goblins-rpg/" target="_blank"><span>MALDITOS GOBLINS RPG</span></a></h2>
  <p>Este site foi feito para ser utilizado em conjunto com o livro <a mat-button href="https://coisinhashop.com.br/produtos/malditos-goblins-rpg/" target="_blank"><span>MALDITOS GOBLINS RPG</span></a></p>
  <div class="row">

    <div class="col-12" >
      <button class="btn btn-primary" (click)="newGoblin()"> Nova Ficha </button>
    </div>

    <div class="col-12 col-md-6" *ngFor="let goblin of goblins">
      <table class="table table-striped table-bordered" [ngClass]="{'table-dark': goblin.isDead,}">
        <thead>
          <tr>

            <th  scope="col" colspan="6">
              Ficha de goblins
            </th>
          </tr>
          <tr>
            <th colspan="6">
              <span >Dados: </span>
              <span class="px-2 me-1 py-1 border rounded border-solid border-black" style="aspect-ratio: '1:1';" [title]="dado.value" *ngFor="let dado of goblin.dados">
                 {{dado.value}}
              </span>
            </th>
          </tr>
        </thead>
        <tbody>
          <tr>
            <th colspan="4">
              Nome: {{goblin.nome}}
            </th>
            
            <th tabindex="0" class="custom-tooltip" style="overflow: visible;" colspan="2">
              Nível:
              <select [value]="goblin?.nivel" (change)="changeGoblinValue($event, goblin)">
                <option value="1" >1</option>
                <option value="2" >2</option>
                <option value="3" >3</option>
                <option value="4" >4</option>
              </select>
              <div class="custom-tooltiptext">Todo goblin começa no nível 1. Sempre que derrotar um oponente, você deverá rolar um dado. Se cair “6”, você ganhará 1 nível. Ganhando níveis, você aprenderá uma nova Técnica da sua ocupação. Se chegar ao nível 4, parabéns! Seu goblin fica tão feliz que explode de alegria</div>
            </th>
           

          </tr>
          <tr>
            <th colspan="3">
              Ocupação: {{goblin?.ocupacao}}
            </th>
            <th colspan="3">
              Descritor: {{goblin?.descritor}}
            </th>

          </tr>

          <tr>
            <th  style="overflow: visible;" colspan="6">
              <span >Características: </span>
              <span tabindex="0" class="px-2 me-1 py-1 border rounded border-solid border-black custom-tooltip" *ngFor="let caracteristica of goblin.caracteristicas">
                 {{caracteristica.nome}}
                 <div class="custom-tooltiptext">{{caracteristica?.descricao}}</div>
              </span>
              
            </th>
          </tr>
          
          <tr>
            <th tabindex="0" class="custom-tooltip" style="overflow: visible;" colspan="2">
              <span >Combate:</span>
              <div class="custom-tooltiptext">Número de dados que você rolará para atacar</div>
            </th>
            <td>
              {{goblin?.combate}}
            </td>
            <td colspan="3" style="position: relative;">
              <strong>Equipamento:</strong>
              <mat-icon style="position: absolute; right: 0; color: green; cursor: pointer;" (click)="addItem(goblin)">add_circle</mat-icon>
            </td>
          </tr>
          <tr>
           
            <th tabindex="0" class="custom-tooltip" style="overflow: visible;" colspan="2">
              <span >Habilidade:</span>
              <div class="custom-tooltiptext">Número de dados que você rolará quando fizer alguma ação fora de combate</div>
            </th>
            <td>
             {{goblin?.habilidade}}
            </td>
            <th colspan="3" rowspan="5">
              
              <div class="mb-2 " style="position: relative;"  *ngFor="let equipamento of goblin.equipamentos;let idx=index;">
                <mat-icon style="position: absolute; right: 0; color: red; cursor: pointer;"  (click)="removeItem(goblin, equipamento, idx)">close</mat-icon>
                <span *ngIf="equipamento?.durabilidade != undefined; else templateArma;">
                  {{equipamento?.nome}}: protege  
                  <span >
                    <select [value]="equipamento?.durabilidade">
                      <option value="0"> 0 </option>
                      <option value="1"> 1 </option>
                      <option value="2"> 2 </option>
                      <option value="3"> 3 </option>
                      <option value="4"> 4 </option>
                    </select>
                  </span> hits
                  <span class="ms-1 " *ngIf="equipamento?.especial && equipamento?.especial.length > 0">
                    <span *ngFor="let especial of equipamento.especial;" 
                      tabindex="0" style="overflow: visible;"
                      class="px-1 me-1 mb-1 custom-tooltip border rounded border-solid border-black">
                      {{especial.nome}}
                      <div class="custom-tooltiptext">{{especial?.descricao}}</div>
                    </span>
                   
                  </span>
                </span>
                <ng-template #templateArma>
                  <span> {{equipamento?.nome}}({{equipamento?.ataque}}): </span>
                  <span *ngIf="equipamento?.durabilidade == undefined && equipamento?.ataque == undefined" >{{equipamento?.descricao }}</span>
                  <span *ngIf="equipamento?.bonus">{{equipamento?.bonus}} </span>

                  <span class="ms-1 " 
                    *ngIf="equipamento?.especial && equipamento?.especial.length > 0">
                    <span *ngFor="let especial of equipamento.especial;" 
                      class="px-1 py-1 me-1 mb-1 border rounded border-solid border-black custom-tooltip" tabindex="0" style="overflow: visible;">
                      {{especial.nome}}
                      <span *ngIf="especial?.quantidade != undefined">
                        <select [value]="especial?.quantidade">
                          <option value="0"> 0 </option>
                          <option value="1"> 1 </option>
                          <option value="2"> 2 </option>
                          <option value="3"> 3 </option>
                          <option value="4"> 4 </option>
                          <option value="5"> 5 </option>
                          <option value="6"> 6 </option>
                          <option value="7"> 7 </option>
                          <option value="8"> 8 </option>
                          <option value="9"> 9 </option>
                          <option value="10"> 10 </option>
                          <option value="11"> 11 </option>
                          <option value="12"> 12 </option>
                          <option value="13"> 13 </option>
                          <option value="14"> 14 </option>
                          <option value="15"> 15 </option>


                        </select> ({{especial?.quantidade}})
                      </span>
                      <div class="custom-tooltiptext">{{especial?.descricao}}</div>
                    </span>
                  </span>
                </ng-template>
   
              </div>
            </th>
           
          </tr>

          <tr>
            <th tabindex="0" class="custom-tooltip" style="overflow: visible;"  colspan="2">
              Noção:
              <div class="custom-tooltiptext"> Número de dados que você rolará para saber se seu personagem conhece algo</div>
            </th>
            <td>
             {{goblin?.nocao}}
            </td>  
            

          </tr>

          <tr>
            
            <th tabindex="0" class="custom-tooltip" style="overflow: visible;"  colspan="2">
              Vitalidade:
              <div class="custom-tooltiptext">Quantidade máxima de ferimentos que seu personagem pode ter antes de morrer</div>
            </th>

            <td>
             {{goblin?.vitalidade}}
            </td>

          </tr>
         
          <tr>
            <th colspan="3" >
              Ferimentos:

              <select [value]="goblin?.ferimento">
                <option value="0" >0</option>
                <option value="1" >1</option>
                <option value="2" >2</option>
                <option value="3" >3</option>
                <option value="4" >4</option>
                <option value="5" >5</option>
                <option value="6" >6</option>
              </select>
            </th>

          </tr>
          

          <tr>
            <th colspan="6">
              habilidades
            </th>
          </tr>
          <tr *ngFor="let poder of goblin.poderes;">
            <td tabindex="0" class="custom-tooltip" style="overflow: visible;" colspan="6" >
              <strong>{{poder.nome}} </strong> 
              <div class="custom-tooltiptext">{{poder.descricao}}</div>
            </td>
          </tr>
          <tr *ngIf=" goblin.magias &&  goblin.magias.length > 0 ">
            <th colspan="6" >
              Magias: <span>{{goblin.magias.join(', ')}} </span>
            </th>
          </tr>

        </tbody>
      </table>
    </div>    
  </div>

</div>
